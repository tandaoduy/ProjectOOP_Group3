@model IEnumerable<ProjectOOP_Group3.Modal.ChiTietPYC>

@{
    ViewBag.Title = "Chi Tiết Phiếu Yêu Cầu";
}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-gray-800">Chi Tiết Phiếu Yêu Cầu: @ViewBag.MaPYC</h1>
        @Html.ActionLink("Quay lại", "PhieuYeuCau", "TraCuu", new { area = "User" }, new { @class = "text-amber-600 hover:text-amber-800" })
    </div>

    <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
            <h2 class="text-lg font-semibold text-gray-800">
                Danh sách mặt hàng: @Model.Count() mặt hàng
            </h2>
        </div>
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mã MH</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tên mặt hàng</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Đơn vị tính</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Số lượng</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nhà cung cấp</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Đơn giá dự kiến</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thành tiền</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                @if (Model != null)
                {
                    foreach (var item in Model)
                    {
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">@item.MaMH</td>
                        <td class="px-6 py-4 text-sm text-gray-900">@(item.MatHang?.TenMH ?? "")</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">@(item.MatHang?.DonViTinh ?? "")</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">@item.SoLuong</td>
                        <td class="px-6 py-4 text-sm text-gray-500">@(item.NhaCungCap?.TenNCC ?? "")</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">@(item.DonGiaDuKien?.ToString("N0") ?? "0") đ</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900">
                            @((item.DonGiaDuKien * item.SoLuong)?.ToString("N0") ?? "0") đ
                        </td>
                    </tr>
                    }
                }
            </tbody>
            <tfoot class="bg-gray-50">
                <tr>
                    <td colspan="6" class="px-6 py-4 text-right text-sm font-semibold text-gray-900">Tổng cộng:</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-amber-600">
                        @{
                            decimal tongTien = 0;
                            if (Model != null)
                            {
                                foreach (var item in Model)
                            {
                                if (item.DonGiaDuKien.HasValue)
                                {
                                    tongTien += item.DonGiaDuKien.Value * item.SoLuong;
                                }
                            }
                            }
                        }
                        @tongTien.ToString("N0") đ
                    </td>
                </tr>
            </tfoot>
        </table>
        @if (Model == null || !Model.Any())
        {
            <div class="text-center py-12 text-gray-500">
                Không có chi tiết nào
            </div>
        }
    </div>
</div>

